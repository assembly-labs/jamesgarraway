<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Playoff Journey - Football Fractions</title>

  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/components.css">
  <link rel="stylesheet" href="../styles/football-theme.css">
  <link rel="stylesheet" href="../styles/broadcast-transitions.css">

  <style>
    /* Team Colors */
    :root {
      --cowboys-blue: #002244;
      --cowboys-silver: #869397;
      --chiefs-red: #E31837;
      --chiefs-gold: #FFB612;
      --lions-blue: #0076B6;
      --lions-silver: #B0B7BC;
      --giants-blue: #0B2265;
      --giants-red: #A71930;
      --bears-navy: #0B162A;
      --bears-orange: #C83803;
      --commanders-burgundy: #5A1414;
      --commanders-gold: #FFB612;
      --eagles-green: #004C54;
      --eagles-silver: #A5ACAF;
    }

    .playoff-intro {
      text-align: center;
      margin-bottom: var(--space-2xl);
      padding: var(--space-xl);
      background: linear-gradient(135deg, var(--eagles-green) 0%, #006d5b 100%);
      border-radius: var(--radius-xl);
      color: white;
    }

    .playoff-intro h2 {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-md);
      margin-bottom: var(--space-md);
    }

    .eagles-logo {
      width: 60px;
      height: 60px;
      object-fit: contain;
    }

    .playoff-intro p {
      font-size: 1.1rem;
      opacity: 0.95;
    }

    .bracket-container {
      display: flex;
      flex-direction: column;
      gap: var(--space-xl);
    }

    .matchup-card {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: 0 4px 20px var(--shadow);
      transition: all var(--transition-normal);
    }

    .matchup-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px var(--shadow);
    }

    .matchup-card.defeated {
      opacity: 0.85;
    }

    .matchup-card.super-bowl {
      border: 3px solid gold;
      box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
    }

    .matchup-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-lg);
      background: linear-gradient(135deg, #1a1a1a 0%, #333 100%);
      color: white;
    }

    .round-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      opacity: 0.8;
    }

    .super-bowl .round-label {
      color: gold;
      font-weight: 700;
    }

    .matchup-status {
      font-size: 0.875rem;
      font-weight: 600;
      padding: var(--space-xs) var(--space-md);
      border-radius: var(--radius-full);
      background: rgba(255,255,255,0.1);
    }

    .matchup-status.defeated {
      background: var(--correct);
      color: white;
    }

    .matchup-status.locked {
      background: #333;
      color: #888;
      font-size: 0.75rem;
    }

    /* Locked card styling */
    .matchup-card:has(.matchup-status.locked) {
      position: relative;
      opacity: 0.7;
    }

    .matchup-card:has(.matchup-status.locked)::before {
      content: 'üîí COMPLETE PREVIOUS GAME FIRST';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: var(--space-lg) var(--space-xl);
      border-radius: var(--radius-lg);
      font-size: 1.1rem;
      font-weight: 900;
      text-align: center;
      z-index: 10;
      white-space: nowrap;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      border: 3px solid #666;
    }

    .matchup-card:has(.matchup-status.locked) .matchup-body,
    .matchup-card:has(.matchup-status.locked) .matchup-footer {
      filter: blur(2px);
      pointer-events: none;
    }

    .btn-locked {
      pointer-events: none;
      opacity: 0.3;
      cursor: not-allowed;
    }

    .matchup-body {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      padding: var(--space-xl);
      gap: var(--space-lg);
    }

    @media (max-width: 600px) {
      .matchup-body {
        grid-template-columns: 1fr;
        text-align: center;
      }
      .vs-divider {
        order: -1;
        margin-bottom: var(--space-md);
      }
    }

    .team-side {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-sm);
    }

    .team-side.eagles {
      order: 0;
    }

    .team-side.opponent {
      order: 2;
    }

    .team-logo {
      width: 80px;
      height: 80px;
      object-fit: contain;
      transition: transform var(--transition-fast);
    }

    .matchup-card:hover .team-logo {
      transform: scale(1.1);
    }

    .team-name {
      font-weight: 700;
      font-size: 1rem;
    }

    .team-side.eagles .team-name {
      color: var(--eagles-green);
    }

    .vs-divider {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-sm);
      order: 1;
    }

    .vs-text {
      font-size: 1.5rem;
      font-weight: 900;
      color: var(--text-light);
    }

    .lesson-title-small {
      font-size: 0.875rem;
      color: var(--text-secondary);
      text-align: center;
      max-width: 150px;
    }

    .matchup-footer {
      padding: var(--space-lg);
      background: var(--background);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: var(--space-md);
    }

    .lesson-objectives-mini {
      flex: 1;
      min-width: 200px;
    }

    .learn-header {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--field-green);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--space-sm);
    }

    .lesson-objectives-mini ul {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .lesson-objectives-mini li {
      display: flex;
      align-items: flex-start;
      gap: var(--space-xs);
      margin-bottom: var(--space-xs);
    }

    .lesson-objectives-mini li::before {
      content: "‚Ä¢";
      color: var(--field-green);
    }

    .matchup-actions {
      display: flex;
      gap: var(--space-sm);
      flex-wrap: wrap;
    }

    /* Defeated overlay */
    .defeated-badge {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-15deg);
      background: var(--correct);
      color: white;
      padding: var(--space-sm) var(--space-lg);
      font-size: clamp(0.875rem, 3vw, 1.25rem);
      font-weight: 900;
      text-transform: uppercase;
      border-radius: var(--radius-md);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 10;
      display: none;
      text-align: center;
      white-space: nowrap;
    }

    .matchup-card.defeated .defeated-badge {
      display: block;
    }

    .matchup-card.defeated .matchup-body {
      position: relative;
    }

    /* Progress tracker */
    .progress-tracker {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      margin-bottom: var(--space-2xl);
      box-shadow: 0 4px 20px var(--shadow);
    }

    .progress-tracker h3 {
      margin-bottom: var(--space-lg);
      text-align: center;
    }

    .bracket-progress {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-xs);
      flex-wrap: wrap;
    }

    .bracket-step {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }

    .bracket-team {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background);
      border: 2px solid var(--border);
      overflow: hidden;
    }

    .bracket-team img {
      width: 30px;
      height: 30px;
      object-fit: contain;
    }

    .bracket-team.defeated {
      border-color: var(--correct);
      background: var(--correct-light);
    }

    .bracket-team.defeated::after {
      content: "‚úì";
      position: absolute;
      font-size: 0.75rem;
      color: var(--correct);
      font-weight: 700;
    }

    .bracket-team.current {
      border-color: var(--thinking);
      background: var(--thinking-light);
      animation: pulse 2s infinite;
    }

    .bracket-arrow {
      color: var(--text-light);
      font-size: 1.25rem;
    }

    .bracket-trophy {
      font-size: 1.5rem;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* Super Bowl special styling */
    .super-bowl .matchup-header {
      background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%);
      border-bottom: 2px solid gold;
    }

    .super-bowl .vs-text {
      color: gold;
    }

    .championship-badge {
      display: none;
      text-align: center;
      padding: var(--space-lg);
      background: linear-gradient(135deg, gold 0%, #ffd700 50%, gold 100%);
      color: #1a1a1a;
      font-weight: 900;
      font-size: 1.25rem;
    }

    .super-bowl.defeated .championship-badge {
      display: block;
    }

    /* Footer styling */
    .site-footer {
      background: var(--field-dark);
      color: white;
      padding: var(--space-xl) 0;
      text-align: center;
      margin-top: var(--space-2xl);
    }

    .site-footer a {
      color: rgba(255, 255, 255, 0.8);
    }

    .site-footer a:hover {
      color: white;
    }

    /* You label for Eagles team */
    .you-label {
      font-size: 0.75rem;
      color: var(--text-light);
    }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="../index.html" class="nav-brand">
        <span>üèà</span>
        <span>Football Fractions</span>
      </a>
      <button class="nav-hamburger" id="navHamburger" aria-label="Toggle menu">‚ò∞</button>
      <ul class="nav-menu" id="navMenu">
        <li><a href="../index.html" class="nav-link">Home</a></li>
        <li><a href="../practice/index.html" class="nav-link">Practice</a></li>
        <li><a href="../lessons/index.html" class="nav-link active">Game Time</a></li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            Parents Stuff <span class="dropdown-arrow">‚ñº</span>
          </a>
          <ul class="nav-dropdown">
            <li><a href="../parent-guide/index.html" class="nav-dropdown-link">Parent Guide</a></li>
            <li><a href="../super-extra-curricular/index.html" class="nav-dropdown-link">Super Extra</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <header class="page-header">
    <div class="container">
      <h1>üèÜ Playoff Journey</h1>
      <p>Beat each opponent to advance to the Super Bowl!</p>
    </div>
  </header>

  <main class="container">
    <!-- Eagles Intro -->
    <div class="playoff-intro">
      <h2>
        <img src="../images/nfl-logos/eagles.png" alt="Eagles" class="eagles-logo">
        You Are The Eagles
        <img src="../images/nfl-logos/eagles.png" alt="Eagles" class="eagles-logo">
      </h2>
      <p>Master each fraction skill to defeat your opponent and advance through the playoffs!</p>
    </div>

    <!-- Progress Tracker -->
    <div class="progress-tracker">
      <h3>Your Playoff Path</h3>
      <div class="bracket-progress" id="bracketProgress">
        <!-- Populated by JS -->
      </div>
    </div>

    <!-- Matchups -->
    <div class="bracket-container" id="bracketContainer">
      <!-- Populated by JS -->
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <p>Football Fractions - Playoff Journey</p>
      <p class="text-small mt-sm">
        <a href="../parent-guide/index.html">Parent Guide</a> ¬∑
        <a href="../practice/index.html">Practice Hub</a>
      </p>
    </div>
  </footer>

  <script src="../js/storage.js"></script>
  <script src="../js/app.js"></script>
  <script src="../js/broadcast-transitions.js"></script>
  <script>
    const matchups = [
      {
        round: 1,
        roundName: 'Wild Card Round',
        lessonNum: 1,
        slug: '01-equal-parts',
        lessonTitle: 'Equal Parts',
        lessonSubtitle: 'What makes parts TRULY equal?',
        team: 'Cowboys',
        teamLogo: 'cowboys.png',
        objectives: [
          'Spot shapes split equally',
          'Divide shapes into equal parts',
          'Sort equal vs not equal'
        ]
      },
      {
        round: 2,
        roundName: 'Divisional Round',
        lessonNum: 2,
        slug: '02-improper-fractions',
        lessonTitle: 'Improper Fractions',
        lessonSubtitle: 'Fractions bigger than 1!',
        team: 'Chiefs',
        teamLogo: 'chiefs.png',
        objectives: [
          'Build improper fractions',
          'Convert to mixed numbers',
          'Convert back to improper'
        ]
      },
      {
        round: 3,
        roundName: 'Conference Semi-Final',
        lessonNum: 3,
        slug: '03-adding-fractions',
        lessonTitle: 'Adding Fractions',
        lessonSubtitle: 'Combining same-sized pieces',
        team: 'Lions',
        teamLogo: 'lions.png',
        objectives: [
          'Add with bar models',
          'Solve like-denominator problems',
          'Tackle word problems'
        ]
      },
      {
        round: 4,
        roundName: 'Conference Final',
        lessonNum: 4,
        slug: '04-subtracting-fractions',
        lessonTitle: 'Subtracting Fractions',
        lessonSubtitle: 'Finding what\'s left',
        team: 'Giants',
        teamLogo: 'giants.png',
        objectives: [
          'Subtract visually',
          'Solve like-denominator problems',
          'Calculate yards to go'
        ]
      },
      {
        round: 5,
        roundName: 'NFC Championship',
        lessonNum: 5,
        slug: '05-simplifying',
        lessonTitle: 'Simplifying Fractions',
        lessonSubtitle: 'Same amount, simpler name',
        team: 'Bears',
        teamLogo: 'bears.png',
        objectives: [
          'Match equivalent fractions',
          'Find the GCF',
          'Reduce to simplest form'
        ]
      },
      {
        round: 6,
        roundName: 'SUPER BOWL',
        lessonNum: 6,
        slug: '06-equivalence',
        lessonTitle: 'Fraction Twins',
        lessonSubtitle: 'Same amount, different names!',
        team: 'Commanders',
        teamLogo: 'commanders.png',
        objectives: [
          'Match on number lines',
          'Create equivalent fractions',
          'Find missing numbers'
        ],
        isSuperBowl: true
      }
    ];

    function renderBracket() {
      const progress = Storage.getLessonProgress();
      const container = document.getElementById('bracketContainer');
      const progressBar = document.getElementById('bracketProgress');

      // Find current round (first incomplete lesson)
      let currentRound = 7; // All complete
      for (let i = 1; i <= 6; i++) {
        if (!progress[i]?.completed) {
          currentRound = i;
          break;
        }
      }

      // Render progress bar
      let progressHTML = '';
      matchups.forEach((m, i) => {
        const isDefeated = progress[m.lessonNum]?.completed;
        const isCurrent = m.lessonNum === currentRound;
        const statusClass = isDefeated ? 'defeated' : (isCurrent ? 'current' : '');

        progressHTML += `
          <div class="bracket-step">
            <div class="bracket-team ${statusClass}">
              <img src="../images/nfl-logos/${m.teamLogo}" alt="${m.team}">
            </div>
            ${i < matchups.length - 1 ? '<span class="bracket-arrow">‚Üí</span>' : ''}
          </div>
        `;
      });
      progressHTML += '<span class="bracket-trophy">üèÜ</span>';
      progressBar.innerHTML = progressHTML;

      // Render matchup cards
      container.innerHTML = matchups.map(m => {
        const lessonProgress = progress[m.lessonNum] || {};
        const isDefeated = lessonProgress.completed;
        const isStarted = lessonProgress.started;
        const isLocked = m.lessonNum > 1 && !progress[m.lessonNum - 1]?.completed;

        const cardClasses = [
          'matchup-card',
          isDefeated ? 'defeated' : '',
          m.isSuperBowl ? 'super-bowl' : ''
        ].filter(Boolean).join(' ');

        const statusText = isDefeated ? '‚úì DEFEATED' : (isLocked ? 'üîí LOCKED' : 'READY');
        const statusClass = isDefeated ? 'defeated' : (isLocked ? 'locked' : '');

        const buttonText = isDefeated ? 'Review Game' : 'Play Game';

        return `
          <div class="${cardClasses}">
            <div class="matchup-header">
              <span class="round-label">${m.roundName}</span>
              <span class="matchup-status ${statusClass}">${statusText}</span>
            </div>

            <div class="matchup-body">
              <div class="team-side eagles">
                <img src="../images/nfl-logos/eagles.png" alt="Eagles" class="team-logo">
                <span class="team-name">Eagles</span>
                <span class="you-label">(You)</span>
              </div>

              <div class="vs-divider">
                <span class="vs-text">VS</span>
                <span class="lesson-title-small">${m.lessonTitle}: ${m.lessonSubtitle}</span>
              </div>

              <div class="team-side opponent">
                <img src="../images/nfl-logos/${m.teamLogo}" alt="${m.team}" class="team-logo">
                <span class="team-name">${m.team}</span>
              </div>

              ${isDefeated ? `<div class="defeated-badge">EAGLES BEAT ${m.team.toUpperCase()}!</div>` : ''}
            </div>

            <div class="matchup-footer">
              <div class="lesson-objectives-mini">
                <div class="learn-header">WHAT YOU WILL LEARN:</div>
                <ul>
                  ${m.objectives.map(obj => `<li>${obj}</li>`).join('')}
                </ul>
              </div>
              <div class="matchup-actions">
                <a href="${m.slug}/index.html"
                   class="btn ${isDefeated ? 'btn-secondary' : 'btn-primary play-game-btn'} ${isLocked ? 'btn-locked' : ''}"
                   data-opponent="${m.team}"
                   data-opponent-logo="../images/nfl-logos/${m.teamLogo}"
                   data-round="${m.roundName}">
                  ${buttonText}
                </a>
                <a href="${m.slug}/worksheet.html" class="btn btn-secondary">
                  Worksheet
                </a>
              </div>
            </div>

            ${m.isSuperBowl && isDefeated ? '<div class="championship-badge">üèÜ SUPER BOWL CHAMPIONS! üèÜ</div>' : ''}
          </div>
        `;
      }).join('');
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderBracket();

      // Bind matchup intro transitions to Play Game buttons
      setTimeout(() => {
        document.querySelectorAll('.play-game-btn:not(.btn-locked)').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            const targetUrl = btn.href;
            const opponent = btn.dataset.opponent;
            const opponentLogo = btn.dataset.opponentLogo;
            const round = btn.dataset.round;

            // Button slam effect
            BroadcastTransitions.buttonSlam(btn, () => {
              // Show matchup intro
              BroadcastTransitions.showMatchupIntro(
                { name: 'EAGLES', logo: '../images/nfl-logos/eagles.png' },
                { name: opponent.toUpperCase(), logo: opponentLogo },
                round,
                () => {
                  window.location.href = targetUrl;
                }
              );
            });
          });
        });
      }, 100);
    });
  </script>
</body>
</html>
