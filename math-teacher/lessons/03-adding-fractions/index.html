<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Lesson 3: Adding Fractions - Football Fractions</title>
  <link rel="stylesheet" href="../../styles/main.css">
  <link rel="stylesheet" href="../../styles/components.css">
  <link rel="stylesheet" href="../../styles/football-theme.css">
  <link rel="stylesheet" href="../../styles/coaches-corner.css">
  <style>
    .lesson-container { max-width: 900px; margin: 0 auto; }
    .activity-section { background: var(--card-bg); border-radius: var(--radius-xl); padding: var(--space-xl); margin-bottom: var(--space-xl); box-shadow: 0 4px 20px var(--shadow); }
    .activity-header { display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 2px solid var(--border); }
    .activity-number { width: 40px; height: 40px; background: var(--field-green); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.25rem; }
    .activity-title { font-size: 1.25rem; font-weight: 700; }
    .concept-intro { background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid var(--field-green); padding: var(--space-lg); border-radius: 0 var(--radius-lg) var(--radius-lg) 0; margin-bottom: var(--space-xl); }
    .concept-intro h3 { color: var(--field-green); margin-bottom: var(--space-md); }
    .football-callout { background: linear-gradient(135deg, var(--field-green) 0%, var(--field-dark) 100%); color: white; padding: var(--space-lg); border-radius: var(--radius-lg); margin: var(--space-lg) 0; }
    /* Football Field Progress Bar */
    :root { --eagles-green: #004C54; --opponent-color: #0076B6; }
    .field-progress { background: linear-gradient(135deg, #1a1a1a 0%, #333 100%); border-radius: var(--radius-xl); padding: var(--space-lg); margin-bottom: var(--space-xl); box-shadow: 0 4px 20px var(--shadow); }
    .field-matchup { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-md); }
    .field-team { display: flex; align-items: center; gap: var(--space-sm); }
    .field-team-logo { width: 40px; height: 40px; object-fit: contain; }
    .field-team-name { color: white; font-weight: 700; font-size: 0.875rem; }
    .field-vs { color: #888; font-weight: 700; font-size: 0.75rem; }
    .field-container { position: relative; height: 50px; background: linear-gradient(90deg, var(--eagles-green) 0%, var(--eagles-green) 10%, var(--field-green) 10%, var(--field-green) 90%, var(--opponent-color) 90%, var(--opponent-color) 100%); border-radius: var(--radius-md); overflow: hidden; }
    .field-yard-markers { position: absolute; top: 0; left: 10%; right: 10%; height: 100%; display: flex; justify-content: space-between; }
    .field-yard-marker { width: 2px; height: 100%; background: rgba(255,255,255,0.3); }
    .field-yard-labels { display: flex; justify-content: space-between; padding: 0 10%; margin-top: var(--space-xs); }
    .field-yard-label { color: #888; font-size: 0.625rem; font-weight: 600; }
    .field-football { position: absolute; top: 50%; transform: translate(-50%, -50%); font-size: 1.5rem; transition: left 0.5s ease; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); z-index: 10; }
    .field-end-zone { position: absolute; top: 0; height: 100%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 900; font-size: 0.625rem; text-transform: uppercase; }
    .field-end-zone.eagles { left: 0; width: 10%; background: var(--eagles-green); }
    .field-end-zone.opponent { right: 0; width: 10%; background: var(--opponent-color); }
    .field-status { text-align: center; color: #888; font-size: 0.75rem; margin-top: var(--space-sm); }
    .field-status strong { color: white; }
    .score-display { display: flex; gap: var(--space-xl); justify-content: center; background: var(--background); padding: var(--space-lg); border-radius: var(--radius-lg); margin-bottom: var(--space-xl); }
    .score-item { text-align: center; }
    .score-value { font-size: 2rem; font-weight: 700; color: var(--field-green); }
    .score-label { font-size: 0.875rem; color: var(--text-secondary); }
    .feedback { padding: var(--space-lg); border-radius: var(--radius-lg); text-align: center; font-weight: 700; margin: var(--space-lg) 0; display: none; }
    .feedback.correct { background: var(--correct-light); color: var(--correct); display: block; }
    .feedback.incorrect { background: var(--incorrect-light); color: var(--incorrect); display: block; }
    .feedback.info { background: var(--info-light); color: var(--info); display: block; }
    .activity-complete { text-align: center; padding: var(--space-xl); background: var(--correct-light); border-radius: var(--radius-lg); display: none; }
    .activity-complete.show { display: block; }
    .activity-complete h3 { color: var(--correct); margin-bottom: var(--space-md); }
    .lesson-nav { display: flex; justify-content: space-between; margin-top: var(--space-2xl); margin-bottom: var(--space-2xl); padding-top: var(--space-lg); border-top: 1px solid var(--border); }

    .bar-model { display: flex; border: 3px solid var(--field-green); border-radius: var(--radius-md); overflow: hidden; height: 60px; margin: var(--space-lg) 0; }
    .bar-section { flex: 1; display: flex; align-items: center; justify-content: center; font-weight: 700; border-right: 1px solid var(--field-green); transition: all var(--transition-fast); }
    .bar-section:last-child { border-right: none; }
    .bar-section.filled { background: var(--field-green); color: white; }
    .bar-section.highlighted { background: #64B5F6; color: white; }

    .equation-display { display: flex; align-items: center; justify-content: center; gap: var(--space-lg); font-size: 2rem; font-weight: 700; margin: var(--space-xl) 0; flex-wrap: wrap; }
    .fraction-box { text-align: center; }
    .fraction-num { border-bottom: 3px solid var(--text); padding-bottom: 4px; }
    .fraction-den { padding-top: 4px; }
    .operator { color: var(--text-secondary); }

    .question-card { background: var(--background); border-radius: var(--radius-lg); padding: var(--space-xl); text-align: center; margin: var(--space-lg) 0; }
    .answer-input { font-size: 1.5rem; padding: var(--space-md); border: 3px solid var(--border); border-radius: var(--radius-md); text-align: center; width: 100px; }
    .answer-input:focus { border-color: var(--field-green); outline: none; }
    .answer-options { display: flex; flex-wrap: wrap; gap: var(--space-md); justify-content: center; margin-top: var(--space-lg); }
    .answer-btn { padding: var(--space-md) var(--space-xl); border: 3px solid var(--border); border-radius: var(--radius-lg); background: white; cursor: pointer; font-size: 1.25rem; font-weight: 700; transition: all var(--transition-fast); }
    .answer-btn:hover { border-color: var(--field-green); transform: scale(1.05); }
    .answer-btn.correct { background: var(--correct-light); border-color: var(--correct); }
    .answer-btn.incorrect { background: var(--incorrect-light); border-color: var(--incorrect); }

    .clickable-bar .bar-section { cursor: pointer; }
    .clickable-bar .bar-section:hover { opacity: 0.8; }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="../../index.html" class="nav-brand"><span>üèà</span><span>Football Fractions</span></a>
      <button class="nav-hamburger" id="navHamburger" aria-label="Toggle menu">‚ò∞</button>
      <ul class="nav-menu" id="navMenu">
        <li><a href="../../index.html" class="nav-link">Home</a></li>
        <li><a href="../../practice/index.html" class="nav-link">Practice</a></li>
        <li><a href="../../lessons/index.html" class="nav-link active">Game Time</a></li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            Parents Stuff <span class="dropdown-arrow">‚ñº</span>
          </a>
          <ul class="nav-dropdown">
            <li><a href="../../parent-guide/index.html" class="nav-dropdown-link">Parent Guide</a></li>
            <li><a href="../../super-extra-curricular/index.html" class="nav-dropdown-link">Super Extra</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <header class="page-header">
    <div class="container">
      <div class="breadcrumb breadcrumb-light"><a href="../index.html">Game Time</a><span>></span><span>Lesson 3</span></div>
      <h1>Lesson 3: Adding Fractions</h1>
      <p>Combining same-sized pieces</p>
    </div>
  </header>

  <main class="container">
    <div class="lesson-container">
      <!-- Football Field Progress Bar -->
      <div class="field-progress">
        <div class="field-matchup">
          <div class="field-team">
            <img src="../../images/nfl-logos/eagles.png" alt="Eagles" class="field-team-logo">
            <span class="field-team-name">Eagles</span>
          </div>
          <span class="field-vs">CONFERENCE SEMI-FINAL</span>
          <div class="field-team">
            <span class="field-team-name">Lions</span>
            <img src="../../images/nfl-logos/lions.png" alt="Lions" class="field-team-logo">
          </div>
        </div>
        <div class="field-container">
          <div class="field-end-zone eagles">GO</div>
          <div class="field-yard-markers"><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div></div>
          <div class="field-football" id="footballPosition" style="left: 10%;">üèà</div>
          <div class="field-end-zone opponent">TD</div>
        </div>
        <div class="field-yard-labels"><span class="field-yard-label">0</span><span class="field-yard-label">25</span><span class="field-yard-label">50</span><span class="field-yard-label">75</span><span class="field-yard-label">100</span></div>
        <div class="field-status"><span id="yardsDisplay"><strong>0</strong> yards gained ‚Ä¢ <strong>100</strong> yards to TD</span></div>
      </div>
      <div class="score-display">
        <div class="score-item"><div class="score-value" id="scoreValue">0</div><div class="score-label">Points</div></div>
        <div class="score-item"><div class="score-value" id="activityNum">1</div><div class="score-label">of 3 Activities</div></div>
      </div>

      <div class="concept-intro">
        <h3>Coach's Lesson: Adding Fractions with Like Denominators</h3>
        <p><strong>The WHY:</strong> Think about it - if you have 3 slices of pizza and get 2 more slices, you now have 5 slices. You're just counting slices! The SIZE of each slice didn't change. That's why we only add the top numbers - we're counting how many same-sized pieces we have.</p>
        <p style="margin-top: var(--space-md);"><strong>The Rule:</strong> When fractions have the <strong>same denominator</strong> (bottom number), just add the numerators (top numbers). The denominator stays the same because you're counting the same-sized pieces!</p>
        <p style="margin-top: var(--space-md);"><strong>The Method:</strong> Step 1: Check that denominators match. Step 2: Add the numerators. Step 3: Keep the denominator the same. Step 4: Simplify if needed.</p>
        <div class="football-callout" style="margin-top: var(--space-lg);">
          <strong>Football Connection:</strong> The field is split into 10 equal sections. <strong>Amon-Ra St. Brown</strong> of the Lions catches a pass for 3 sections, then <strong>Jahmyr Gibbs</strong> runs for 2 more sections. How many sections total? 3 + 2 = 5 sections, or 5/10 of the field! Coach <strong>Dan Campbell</strong> knows: the sections didn't get bigger - the Lions just covered MORE of them!
        </div>
      </div>

      <!-- Activity 1: Visual Bar Model Adding -->
      <div class="activity-section" id="activity1">
        <div class="activity-header">
          <div class="activity-number">1</div>
          <div class="activity-title">See the Addition</div>
        </div>
        <p>Click on the bar sections to add the fractions together. Watch how they combine!</p>
        <div id="barActivity"></div>
        <div class="feedback" id="feedback1"></div>
        <div class="activity-complete" id="complete1">
          <h3>Great Work!</h3>
          <p>You can see how adding fractions works visually!</p>
          <button class="btn btn-primary" onclick="Lesson.showActivity(2)">Continue to Activity 2</button>
        </div>
      </div>

      <!-- Activity 2: Solve Addition Problems -->
      <div class="activity-section" id="activity2" style="display: none;">
        <div class="activity-header">
          <div class="activity-number">2</div>
          <div class="activity-title">Add the Fractions</div>
        </div>
        <p>Solve these addition problems. Remember: add the top numbers, keep the bottom number the same!</p>
        <div class="question-card" id="addQuestion"></div>
        <div class="feedback" id="feedback2"></div>
        <div class="activity-complete" id="complete2">
          <h3>Addition Pro!</h3>
          <p>You can add fractions with like denominators!</p>
          <button class="btn btn-primary" onclick="Lesson.showActivity(3)">Continue to Activity 3</button>
        </div>
      </div>

      <!-- Activity 3: Word Problems -->
      <div class="activity-section" id="activity3" style="display: none;">
        <div class="activity-header">
          <div class="activity-number">3</div>
          <div class="activity-title">Football Word Problems</div>
        </div>
        <p>Solve these football-themed addition problems!</p>
        <div class="question-card" id="wordProblem"></div>
        <div class="feedback" id="feedback3"></div>
        <div class="activity-complete" id="complete3">
          <h3>Lesson Complete!</h3>
          <p>You can add fractions like a pro!</p>
          <button class="btn btn-success btn-large" onclick="Lesson.completeLesson()">Finish Lesson</button>
        </div>
      </div>

      <div class="lesson-nav">
        <a href="../02-improper-fractions/index.html" class="btn btn-secondary">‚Üê Previous: Improper Fractions</a>
        <a href="../04-subtracting-fractions/index.html" class="btn btn-secondary">Next: Subtracting Fractions ‚Üí</a>
      </div>
    </div>
  </main>

  <script src="../../js/storage.js"></script>
  <script src="../../js/fractions.js"></script>
  <script src="../../js/app.js"></script>
  <script src="../../js/coaches-corner.js"></script>
  <script>
    const Lesson = {
      score: 0, currentActivity: 1, totalActivities: 3,

      barChallenges: [
        { num1: 2, num2: 3, den: 8 },
        { num1: 1, num2: 2, den: 4 },
        { num1: 3, num2: 4, den: 10 }
      ],
      currentBarIndex: 0,
      clickedSections: new Set(),

      addChallenges: [
        { num1: 2, num2: 3, den: 8, answer: '5/8' },
        { num1: 1, num2: 2, den: 5, answer: '3/5' },
        { num1: 3, num2: 2, den: 6, answer: '5/6' },
        { num1: 4, num2: 3, den: 10, answer: '7/10' }
      ],
      currentAddIndex: 0,

      wordProblems: [
        { text: 'Cooper DeJean runs 2/8 of the field, then 3/8 more. How far did he run total?', answer: '5/8' },
        { text: 'Jalen Hurts throws for 1/4 of the field, then runs for 2/4 more. Total distance?', answer: '3/4' },
        { text: 'The Eagles gained 4/10 of the field on one play, then 5/10 on the next. Total yards?', answer: '9/10' }
      ],
      currentWordIndex: 0,

      init() {
        Storage.startLesson(3);
        this.renderBarActivity();
        this.renderAddActivity();
        this.renderWordProblem();
        this.updateProgress();
      },

      renderBarActivity() {
        const c = this.barChallenges[this.currentBarIndex];
        this.clickedSections = new Set();
        const container = document.getElementById('barActivity');
        container.innerHTML = `
          <div class="equation-display">
            <div class="fraction-box"><div class="fraction-num">${c.num1}</div><div class="fraction-den">${c.den}</div></div>
            <span class="operator">+</span>
            <div class="fraction-box"><div class="fraction-num">${c.num2}</div><div class="fraction-den">${c.den}</div></div>
            <span class="operator">=</span>
            <div class="fraction-box"><div class="fraction-num" id="resultNum">?</div><div class="fraction-den">${c.den}</div></div>
          </div>
          <p style="text-align:center;">Click ${c.num1 + c.num2} sections to show the total:</p>
          <div class="bar-model clickable-bar" id="barModel">
            ${Array(c.den).fill(0).map((_, i) => `<div class="bar-section" data-idx="${i}" onclick="Lesson.clickSection(${i})">1/${c.den}</div>`).join('')}
          </div>
          <p style="text-align:center;">Selected: <strong id="selectedCount">0</strong> / ${c.num1 + c.num2}</p>
        `;
      },

      clickSection(idx) {
        const section = document.querySelector(`[data-idx="${idx}"]`);
        const c = this.barChallenges[this.currentBarIndex];
        if (this.clickedSections.has(idx)) {
          this.clickedSections.delete(idx);
          section.classList.remove('filled');
        } else {
          this.clickedSections.add(idx);
          section.classList.add('filled');
        }
        document.getElementById('selectedCount').textContent = this.clickedSections.size;
        document.getElementById('resultNum').textContent = this.clickedSections.size || '?';

        if (this.clickedSections.size === c.num1 + c.num2) {
          const feedback = document.getElementById('feedback1');
          feedback.textContent = `Correct! ${c.num1}/${c.den} + ${c.num2}/${c.den} = ${c.num1+c.num2}/${c.den}`;
          feedback.className = 'feedback correct';
          this.score += 5;
          this.updateScore();
          setTimeout(() => {
            this.currentBarIndex++;
            if (this.currentBarIndex < this.barChallenges.length) {
              feedback.className = 'feedback';
              this.renderBarActivity();
            } else {
              document.getElementById('complete1').classList.add('show');
            }
          }, 1500);
        }
      },

      renderAddActivity() {
        const c = this.addChallenges[this.currentAddIndex];
        const wrong = [`${c.num1+c.num2}/${c.den*2}`, `${c.num1+c.num2+1}/${c.den}`, `${c.num1}/${c.den}`];
        const all = [c.answer, ...wrong].sort(() => Math.random() - 0.5);
        document.getElementById('addQuestion').innerHTML = `
          <div class="equation-display">
            <div class="fraction-box"><div class="fraction-num">${c.num1}</div><div class="fraction-den">${c.den}</div></div>
            <span class="operator">+</span>
            <div class="fraction-box"><div class="fraction-num">${c.num2}</div><div class="fraction-den">${c.den}</div></div>
            <span class="operator">=</span>
            <span style="font-size:2rem;">?</span>
          </div>
          <div class="answer-options">${all.map(a => `<button class="answer-btn" onclick="Lesson.checkAdd('${a}')">${a}</button>`).join('')}</div>
        `;
      },

      checkAdd(answer) {
        const c = this.addChallenges[this.currentAddIndex];
        const feedback = document.getElementById('feedback2');
        document.querySelectorAll('#addQuestion .answer-btn').forEach(btn => {
          btn.disabled = true;
          if (btn.textContent === c.answer) btn.classList.add('correct');
          else if (btn.textContent === answer) btn.classList.add('incorrect');
        });
        if (answer === c.answer) {
          feedback.textContent = `Correct! ${c.num1} + ${c.num2} = ${c.num1+c.num2}, denominator stays ${c.den}`;
          feedback.className = 'feedback correct';
          this.score += 5;
          this.updateScore();
        } else {
          feedback.textContent = `Remember: add the numerators, keep the denominator!`;
          feedback.className = 'feedback incorrect';
        }
        setTimeout(() => {
          this.currentAddIndex++;
          if (this.currentAddIndex < this.addChallenges.length) {
            feedback.className = 'feedback';
            this.renderAddActivity();
          } else {
            document.getElementById('complete2').classList.add('show');
          }
        }, 1500);
      },

      renderWordProblem() {
        const p = this.wordProblems[this.currentWordIndex];
        const wrong = this.generateWrongAnswers(p.answer);
        const all = [p.answer, ...wrong].sort(() => Math.random() - 0.5);
        document.getElementById('wordProblem').innerHTML = `
          <p style="font-size:1.25rem; margin-bottom:var(--space-lg);">${p.text}</p>
          <div class="answer-options">${all.map(a => `<button class="answer-btn" onclick="Lesson.checkWord('${a}')">${a}</button>`).join('')}</div>
        `;
      },

      generateWrongAnswers(correct) {
        const [num, den] = correct.split('/').map(Number);
        return [`${num+1}/${den}`, `${num}/${den*2}`, `${num-1}/${den}`].filter(w => w !== correct).slice(0,3);
      },

      checkWord(answer) {
        const p = this.wordProblems[this.currentWordIndex];
        const feedback = document.getElementById('feedback3');
        document.querySelectorAll('#wordProblem .answer-btn').forEach(btn => {
          btn.disabled = true;
          if (btn.textContent === p.answer) btn.classList.add('correct');
          else if (btn.textContent === answer) btn.classList.add('incorrect');
        });
        if (answer === p.answer) {
          feedback.textContent = `Touchdown! ${p.answer} is correct!`;
          feedback.className = 'feedback correct';
          this.score += 10;
          this.updateScore();
        } else {
          feedback.textContent = `The correct answer is ${p.answer}`;
          feedback.className = 'feedback incorrect';
        }
        setTimeout(() => {
          this.currentWordIndex++;
          if (this.currentWordIndex < this.wordProblems.length) {
            feedback.className = 'feedback';
            this.renderWordProblem();
          } else {
            document.getElementById('complete3').classList.add('show');
          }
        }, 1500);
      },

      showActivity(num) {
        for (let i = 1; i <= 3; i++) document.getElementById(`activity${i}`).style.display = 'none';
        document.getElementById(`activity${num}`).style.display = 'block';
        this.currentActivity = num;
        document.getElementById('activityNum').textContent = num;
        this.updateProgress();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      },

      updateScore() { document.getElementById('scoreValue').textContent = this.score; },

      updateProgress() {
        const progressPercent = (this.currentActivity - 1) / this.totalActivities;
        const fieldPosition = 10 + (progressPercent * 80);
        const yards = Math.round(progressPercent * 100);
        document.getElementById('footballPosition').style.left = `${fieldPosition}%`;
        document.getElementById('yardsDisplay').innerHTML = `<strong>${yards}</strong> yards gained ‚Ä¢ <strong>${100 - yards}</strong> yards to TD`;
      },

      completeLesson() {
        Storage.completeLesson(3);
        document.getElementById('footballPosition').style.left = '90%';
        document.getElementById('yardsDisplay').innerHTML = '<strong>TOUCHDOWN!</strong>';
        setTimeout(() => { App.celebrateVictory('Lions', 3, '../../images/nfl-logos/lions.png'); }, 500);
      }
    };

    document.addEventListener('DOMContentLoaded', () => {
      Lesson.init();
      CoachesCorner.init(3);
    });
  </script>
</body>
</html>
