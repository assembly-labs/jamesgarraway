<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Lesson 2: Improper Fractions & Mixed Numbers - Football Fractions</title>

  <link rel="stylesheet" href="../../styles/main.css">
  <link rel="stylesheet" href="../../styles/components.css">
  <link rel="stylesheet" href="../../styles/football-theme.css">
  <link rel="stylesheet" href="../../styles/coaches-corner.css">

  <style>
    .lesson-container { max-width: 900px; margin: 0 auto; }
    .activity-section { background: var(--card-bg); border-radius: var(--radius-xl); padding: var(--space-xl); margin-bottom: var(--space-xl); box-shadow: 0 4px 20px var(--shadow); }
    .activity-header { display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 2px solid var(--border); }
    .activity-number { width: 40px; height: 40px; background: var(--field-green); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.25rem; }
    .activity-title { font-size: 1.25rem; font-weight: 700; color: var(--text); }
    .concept-intro { background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid var(--field-green); padding: var(--space-lg); border-radius: 0 var(--radius-lg) var(--radius-lg) 0; margin-bottom: var(--space-xl); }
    .concept-intro h3 { color: var(--field-green); margin-bottom: var(--space-md); }
    .football-callout { background: linear-gradient(135deg, var(--field-green) 0%, var(--field-dark) 100%); color: white; padding: var(--space-lg); border-radius: var(--radius-lg); margin: var(--space-lg) 0; }
    /* Football Field Progress Bar */
    :root { --eagles-green: #004C54; --opponent-color: #E31837; }
    .field-progress { background: linear-gradient(135deg, #1a1a1a 0%, #333 100%); border-radius: var(--radius-xl); padding: var(--space-lg); margin-bottom: var(--space-xl); box-shadow: 0 4px 20px var(--shadow); }
    .field-matchup { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-md); }
    .field-team { display: flex; align-items: center; gap: var(--space-sm); }
    .field-team-logo { width: 40px; height: 40px; object-fit: contain; }
    .field-team-name { color: white; font-weight: 700; font-size: 0.875rem; }
    .field-vs { color: #888; font-weight: 700; font-size: 0.75rem; }
    .field-container { position: relative; height: 50px; background: linear-gradient(90deg, var(--eagles-green) 0%, var(--eagles-green) 10%, var(--field-green) 10%, var(--field-green) 90%, var(--opponent-color) 90%, var(--opponent-color) 100%); border-radius: var(--radius-md); overflow: hidden; }
    .field-yard-markers { position: absolute; top: 0; left: 10%; right: 10%; height: 100%; display: flex; justify-content: space-between; }
    .field-yard-marker { width: 2px; height: 100%; background: rgba(255,255,255,0.3); }
    .field-yard-labels { display: flex; justify-content: space-between; padding: 0 10%; margin-top: var(--space-xs); }
    .field-yard-label { color: #888; font-size: 0.625rem; font-weight: 600; }
    .field-football { position: absolute; top: 50%; transform: translate(-50%, -50%); font-size: 1.5rem; transition: left 0.5s ease; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); z-index: 10; }
    .field-end-zone { position: absolute; top: 0; height: 100%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 900; font-size: 0.625rem; text-transform: uppercase; }
    .field-end-zone.eagles { left: 0; width: 10%; background: var(--eagles-green); }
    .field-end-zone.opponent { right: 0; width: 10%; background: var(--opponent-color); }
    .field-status { text-align: center; color: #888; font-size: 0.75rem; margin-top: var(--space-sm); }
    .field-status strong { color: white; }
    .score-display { display: flex; gap: var(--space-xl); justify-content: center; background: var(--background); padding: var(--space-lg); border-radius: var(--radius-lg); margin-bottom: var(--space-xl); }
    .score-item { text-align: center; }
    .score-value { font-size: 2rem; font-weight: 700; color: var(--field-green); }
    .score-label { font-size: 0.875rem; color: var(--text-secondary); }
    .feedback { padding: var(--space-lg); border-radius: var(--radius-lg); text-align: center; font-weight: 700; margin: var(--space-lg) 0; display: none; }
    .feedback.correct { background: var(--correct-light); color: var(--correct); display: block; }
    .feedback.incorrect { background: var(--incorrect-light); color: var(--incorrect); display: block; }
    .feedback.info { background: var(--info-light); color: var(--info); display: block; }
    .activity-complete { text-align: center; padding: var(--space-xl); background: var(--correct-light); border-radius: var(--radius-lg); display: none; }
    .activity-complete.show { display: block; }
    .activity-complete h3 { color: var(--correct); margin-bottom: var(--space-md); }
    .lesson-nav { display: flex; justify-content: space-between; margin-top: var(--space-2xl); margin-bottom: var(--space-2xl); padding-top: var(--space-lg); border-top: 1px solid var(--border); }

    /* Fraction builder */
    .fraction-builder { display: flex; flex-wrap: wrap; gap: var(--space-lg); justify-content: center; margin: var(--space-xl) 0; }
    .whole-circle { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--field-green); background: var(--correct-light); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.875rem; }
    .whole-circle.filled { background: var(--field-green); color: white; }
    .partial-circle { width: 80px; height: 80px; position: relative; }
    .partial-circle svg { width: 100%; height: 100%; }

    /* Clickable pieces */
    .pieces-container { display: flex; flex-wrap: wrap; gap: var(--space-md); justify-content: center; margin: var(--space-lg) 0; }
    .piece { width: 60px; height: 60px; border-radius: 50%; border: 3px solid var(--border); cursor: pointer; transition: all var(--transition-fast); display: flex; align-items: center; justify-content: center; font-weight: 700; }
    .piece:hover { transform: scale(1.1); border-color: var(--field-green); }
    .piece.selected { background: var(--field-green); color: white; border-color: var(--field-green); }

    /* Conversion display */
    .conversion-display { display: flex; align-items: center; justify-content: center; gap: var(--space-xl); margin: var(--space-xl) 0; flex-wrap: wrap; }
    .fraction-display { text-align: center; }
    .fraction-big { font-size: 2.5rem; font-weight: 700; }
    .fraction-line { width: 40px; height: 4px; background: var(--text); margin: var(--space-xs) auto; }
    .equals-sign { font-size: 2rem; font-weight: 700; color: var(--text-secondary); }
    .mixed-display { font-size: 2.5rem; font-weight: 700; }

    /* Question cards */
    .question-card { background: var(--background); border-radius: var(--radius-lg); padding: var(--space-xl); text-align: center; margin: var(--space-lg) 0; }
    .question-text { font-size: 1.25rem; margin-bottom: var(--space-lg); }
    .answer-options { display: flex; flex-wrap: wrap; gap: var(--space-md); justify-content: center; }
    .answer-btn { padding: var(--space-md) var(--space-xl); border: 3px solid var(--border); border-radius: var(--radius-lg); background: white; cursor: pointer; font-size: 1.25rem; font-weight: 700; transition: all var(--transition-fast); min-width: 120px; }
    .answer-btn:hover { border-color: var(--field-green); transform: scale(1.05); }
    .answer-btn.selected { background: var(--info-light); border-color: var(--info); transform: scale(1.05); }
    .answer-btn.correct { background: var(--correct-light); border-color: var(--correct); }
    .answer-btn.incorrect { background: var(--incorrect-light); border-color: var(--incorrect); }

    /* Visual builder */
    .visual-builder { background: var(--background); border-radius: var(--radius-lg); padding: var(--space-xl); margin: var(--space-lg) 0; }
    .builder-controls { display: flex; gap: var(--space-md); justify-content: center; margin-top: var(--space-lg); }
    .builder-btn { width: 50px; height: 50px; border-radius: 50%; border: none; background: var(--field-green); color: white; font-size: 1.5rem; cursor: pointer; transition: all var(--transition-fast); }
    .builder-btn:hover { transform: scale(1.1); background: var(--field-dark); }
    .builder-btn:disabled { background: var(--border); cursor: not-allowed; transform: none; }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="../../index.html" class="nav-brand"><span>üèà</span><span>Football Fractions</span></a>
      <button class="nav-hamburger" id="navHamburger" aria-label="Toggle menu">‚ò∞</button>
      <ul class="nav-menu" id="navMenu">
        <li><a href="../../index.html" class="nav-link">Home</a></li>
        <li><a href="../../practice/index.html" class="nav-link">Practice</a></li>
        <li><a href="../../lessons/index.html" class="nav-link active">Game Time</a></li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            Parents Stuff <span class="dropdown-arrow">‚ñº</span>
          </a>
          <ul class="nav-dropdown">
            <li><a href="../../parent-guide/index.html" class="nav-dropdown-link">Parent Guide</a></li>
            <li><a href="../../super-extra-curricular/index.html" class="nav-dropdown-link">Super Extra</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <header class="page-header">
    <div class="container">
      <div class="breadcrumb breadcrumb-light"><a href="../index.html">Game Time</a><span>></span><span>Lesson 2</span></div>
      <h1>Lesson 2: Improper Fractions & Mixed Numbers</h1>
      <p>Fractions can be bigger than 1!</p>
    </div>
  </header>

  <main class="container">
    <div class="lesson-container">
      <!-- Football Field Progress Bar -->
      <div class="field-progress">
        <div class="field-matchup">
          <div class="field-team">
            <img src="../../images/nfl-logos/eagles.png" alt="Eagles" class="field-team-logo">
            <span class="field-team-name">Eagles</span>
          </div>
          <span class="field-vs">DIVISIONAL ROUND</span>
          <div class="field-team">
            <span class="field-team-name">Chiefs</span>
            <img src="../../images/nfl-logos/chiefs.png" alt="Chiefs" class="field-team-logo">
          </div>
        </div>
        <div class="field-container">
          <div class="field-end-zone eagles">GO</div>
          <div class="field-yard-markers"><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div><div class="field-yard-marker"></div></div>
          <div class="field-football" id="footballPosition" style="left: 10%;">üèà</div>
          <div class="field-end-zone opponent">TD</div>
        </div>
        <div class="field-yard-labels"><span class="field-yard-label">0</span><span class="field-yard-label">25</span><span class="field-yard-label">50</span><span class="field-yard-label">75</span><span class="field-yard-label">100</span></div>
        <div class="field-status"><span id="yardsDisplay"><strong>0</strong> yards gained ‚Ä¢ <strong>100</strong> yards to TD</span></div>
      </div>

      <div class="score-display">
        <div class="score-item"><div class="score-value" id="scoreValue">0</div><div class="score-label">Points</div></div>
        <div class="score-item"><div class="score-value" id="activityNum">1</div><div class="score-label">of 3 Activities</div></div>
      </div>

      <div class="concept-intro">
        <h3>Coach's Lesson: Fractions Greater Than 1</h3>
        <p><strong>The WHY:</strong> Sometimes you have MORE than one whole thing! Imagine eating 5 quarter-slices of pizza. You ate more than 1 whole pizza. Fractions can show amounts bigger than 1 - we call these "improper fractions."</p>
        <p style="margin-top: var(--space-md);"><strong>The Two Ways:</strong> An <strong>improper fraction</strong> has a top number bigger than the bottom (like 5/4). A <strong>mixed number</strong> shows it differently: whole ones + leftover parts (like 1 1/4). They mean the SAME thing!</p>
        <p style="margin-top: var(--space-md);"><strong>How to Convert:</strong> To go from improper to mixed: divide top by bottom. The answer is your whole number, the remainder is your new top number, the bottom stays the same. Example: 7√∑4 = 1 remainder 3, so 7/4 = 1 3/4</p>
        <div class="football-callout" style="margin-top: var(--space-lg);">
          <strong>Football Connection:</strong> Imagine the Eagles game goes to overtime. Instead of the normal 4 quarters, they play <strong>5 quarters</strong>! That's 5/4 of a game - an improper fraction because 5 is bigger than 4. As a mixed number? That's 1 whole game plus 1/4 more = <strong>1 1/4 games</strong> of football! When <strong>Saquon Barkley</strong> rushes through 7 quarter-field sections (each section is 25 yards), he's covered 7/4 of the field, or 1 3/4 fields worth of ground. Same distance, two ways to say it!
        </div>
      </div>

      <!-- Activity 1: Build the Fraction -->
      <div class="activity-section" id="activity1">
        <div class="activity-header">
          <div class="activity-number">1</div>
          <div class="activity-title">Build the Fraction</div>
        </div>
        <p>Click the pieces to build the improper fraction shown. Watch how it becomes more than 1 whole!</p>

        <div class="question-card">
          <div class="question-text">Build: <span id="targetFraction" style="font-size: 2rem; font-weight: 700; color: var(--field-green);">5/4</span></div>
          <div class="fraction-builder" id="fractionBuilder"></div>
          <p style="margin-top: var(--space-md);">Selected: <strong id="selectedCount">0</strong> / <span id="targetNum">5</span> quarters</p>
          <div id="buildSubmitContainer" style="margin-top: var(--space-lg); text-align: center;"></div>
        </div>

        <div class="feedback" id="feedback1"></div>
        <div class="activity-complete" id="complete1">
          <h3>Great Job!</h3>
          <p>You can see how improper fractions make more than 1 whole!</p>
          <button class="btn btn-primary" onclick="Lesson.showActivity(2)">Continue to Activity 2</button>
        </div>
      </div>

      <!-- Activity 2: Convert Improper to Mixed -->
      <div class="activity-section" id="activity2" style="display: none;">
        <div class="activity-header">
          <div class="activity-number">2</div>
          <div class="activity-title">Convert to Mixed Numbers</div>
        </div>
        <p>Convert these improper fractions to mixed numbers. Think: how many whole ones, and how many parts left over?</p>

        <div class="question-card" id="conversionQuestion"></div>
        <div class="feedback" id="feedback2"></div>
        <div class="activity-complete" id="complete2">
          <h3>Conversion Master!</h3>
          <p>You can convert between improper fractions and mixed numbers!</p>
          <button class="btn btn-primary" onclick="Lesson.showActivity(3)">Continue to Activity 3</button>
        </div>
      </div>

      <!-- Activity 3: Convert Mixed to Improper -->
      <div class="activity-section" id="activity3" style="display: none;">
        <div class="activity-header">
          <div class="activity-number">3</div>
          <div class="activity-title">Convert to Improper Fractions</div>
        </div>
        <p>Now go the other way! Convert mixed numbers to improper fractions.</p>

        <div class="question-card" id="reverseQuestion"></div>
        <div class="feedback" id="feedback3"></div>
        <div class="activity-complete" id="complete3">
          <h3>Lesson Complete!</h3>
          <p>You understand improper fractions and mixed numbers!</p>
          <button class="btn btn-success btn-large" onclick="Lesson.completeLesson()">Finish Lesson</button>
        </div>
      </div>

      <div class="lesson-nav">
        <a href="../01-equal-parts/index.html" class="btn btn-secondary">‚Üê Previous: Equal Parts</a>
        <a href="../03-adding-fractions/index.html" class="btn btn-secondary">Next: Adding Fractions ‚Üí</a>
      </div>
    </div>
  </main>

  <script src="../../js/storage.js"></script>
  <script src="../../js/fractions.js"></script>
  <script src="../../js/app.js"></script>
  <script src="../../js/coaches-corner.js"></script>
  <script>
    const Lesson = {
      score: 0,
      currentActivity: 1,
      totalActivities: 3,

      // Activity 1: Build improper fractions
      buildChallenges: [
        { num: 5, den: 4 },
        { num: 7, den: 4 },
        { num: 9, den: 4 }
      ],
      currentBuildIndex: 0,
      selectedPieces: 0,

      // Activity 2: Convert improper to mixed
      convertChallenges: [
        { num: 5, den: 4, answer: '1 1/4' },
        { num: 7, den: 3, answer: '2 1/3' },
        { num: 9, den: 2, answer: '4 1/2' },
        { num: 11, den: 4, answer: '2 3/4' }
      ],
      currentConvertIndex: 0,
      selectedConvertAnswer: null,

      // Activity 3: Convert mixed to improper
      reverseChallenges: [
        { whole: 1, num: 2, den: 4, answer: '6/4' },
        { whole: 2, num: 1, den: 3, answer: '7/3' },
        { whole: 3, num: 1, den: 2, answer: '7/2' },
        { whole: 1, num: 3, den: 4, answer: '7/4' }
      ],
      currentReverseIndex: 0,
      selectedReverseAnswer: null,

      init() {
        Storage.startLesson(2);
        this.renderBuildActivity();
        this.renderConvertActivity();
        this.renderReverseActivity();
        this.updateProgress();
      },

      renderBuildActivity() {
        const challenge = this.buildChallenges[this.currentBuildIndex];
        this.selectedPieces = 0;

        document.getElementById('targetFraction').textContent = `${challenge.num}/${challenge.den}`;
        document.getElementById('targetNum').textContent = challenge.num;
        document.getElementById('selectedCount').textContent = 0;

        const builder = document.getElementById('fractionBuilder');
        const totalPieces = Math.ceil(challenge.num / challenge.den) * challenge.den;

        let html = '';
        for (let i = 0; i < totalPieces; i++) {
          const wholeNum = Math.floor(i / challenge.den);
          html += `<div class="piece" data-index="${i}" onclick="Lesson.togglePiece(${i})">${i % challenge.den + 1}/${challenge.den}</div>`;
        }
        builder.innerHTML = html;

        // Add submit button
        const container = document.getElementById('buildSubmitContainer');
        if (container) {
          container.innerHTML = '<button class="btn btn-primary" id="submitBuild" onclick="Lesson.checkBuild()">Submit Answer</button>';
        }
      },

      togglePiece(index) {
        const piece = document.querySelector(`[data-index="${index}"]`);

        if (piece.classList.contains('selected')) {
          piece.classList.remove('selected');
          this.selectedPieces--;
        } else {
          piece.classList.add('selected');
          this.selectedPieces++;
        }

        document.getElementById('selectedCount').textContent = this.selectedPieces;
        // Clear any previous feedback
        document.getElementById('feedback1').className = 'feedback';
      },

      checkBuild() {
        const challenge = this.buildChallenges[this.currentBuildIndex];
        const feedback = document.getElementById('feedback1');

        if (this.selectedPieces === challenge.num) {
          feedback.textContent = `Perfect! ${challenge.num}/${challenge.den} = ${Math.floor(challenge.num/challenge.den)} ${challenge.num % challenge.den}/${challenge.den} (more than 1 whole!)`;
          feedback.className = 'feedback correct';
          this.score += 5;
          this.updateScore();
          document.getElementById('submitBuild').disabled = true;

          setTimeout(() => {
            this.currentBuildIndex++;
            if (this.currentBuildIndex < this.buildChallenges.length) {
              feedback.className = 'feedback';
              this.renderBuildActivity();
            } else {
              document.getElementById('complete1').classList.add('show');
            }
          }, 1500);
        } else {
          feedback.textContent = `You selected ${this.selectedPieces} pieces, but need exactly ${challenge.num} pieces.`;
          feedback.className = 'feedback incorrect';
        }
      },

      renderConvertActivity() {
        const challenge = this.convertChallenges[this.currentConvertIndex];
        this.selectedConvertAnswer = null;
        const container = document.getElementById('conversionQuestion');

        // Generate wrong answers
        const wrongAnswers = this.generateWrongMixedAnswers(challenge);
        const allAnswers = [challenge.answer, ...wrongAnswers].sort(() => Math.random() - 0.5);

        container.innerHTML = `
          <div class="question-text">
            Convert <span style="font-size: 2rem; font-weight: 700; color: var(--field-green);">${challenge.num}/${challenge.den}</span> to a mixed number:
          </div>
          <div class="answer-options">
            ${allAnswers.map(a => `<button class="answer-btn" onclick="Lesson.selectConvertAnswer('${a}', this)">${a}</button>`).join('')}
          </div>
          <button class="btn btn-primary" id="submitConvert" onclick="Lesson.checkConvert()" style="margin-top: var(--space-lg);">Submit Answer</button>
        `;
      },

      generateWrongMixedAnswers(challenge) {
        const correct = challenge.answer;
        const wrong = [];
        const whole = Math.floor(challenge.num / challenge.den);
        const remainder = challenge.num % challenge.den;

        // Generate plausible wrong answers
        if (whole > 0) wrong.push(`${whole} ${remainder + 1}/${challenge.den}`);
        if (whole > 1) wrong.push(`${whole - 1} ${remainder}/${challenge.den}`);
        wrong.push(`${whole + 1} ${remainder}/${challenge.den}`);

        return wrong.filter(w => w !== correct).slice(0, 3);
      },

      selectConvertAnswer(answer, btn) {
        this.selectedConvertAnswer = answer;
        document.querySelectorAll('#conversionQuestion .answer-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        document.getElementById('feedback2').className = 'feedback';
      },

      checkConvert() {
        if (!this.selectedConvertAnswer) {
          const feedback = document.getElementById('feedback2');
          feedback.textContent = 'Please select an answer first!';
          feedback.className = 'feedback info';
          return;
        }
        const challenge = this.convertChallenges[this.currentConvertIndex];
        const buttons = document.querySelectorAll('#conversionQuestion .answer-btn');
        const feedback = document.getElementById('feedback2');
        const answer = this.selectedConvertAnswer;

        buttons.forEach(btn => {
          btn.disabled = true;
          if (btn.textContent === challenge.answer) {
            btn.classList.add('correct');
          } else if (btn.textContent === answer && answer !== challenge.answer) {
            btn.classList.add('incorrect');
          }
        });
        document.getElementById('submitConvert').disabled = true;

        if (answer === challenge.answer) {
          feedback.textContent = `Correct! ${challenge.num}/${challenge.den} = ${challenge.answer}`;
          feedback.className = 'feedback correct';
          this.score += 5;
          this.updateScore();
        } else {
          feedback.textContent = `Not quite. ${challenge.num} √∑ ${challenge.den} = ${Math.floor(challenge.num/challenge.den)} remainder ${challenge.num % challenge.den}`;
          feedback.className = 'feedback incorrect';
        }

        setTimeout(() => {
          this.currentConvertIndex++;
          if (this.currentConvertIndex < this.convertChallenges.length) {
            feedback.className = 'feedback';
            this.renderConvertActivity();
          } else {
            document.getElementById('complete2').classList.add('show');
          }
        }, 1500);
      },

      renderReverseActivity() {
        const challenge = this.reverseChallenges[this.currentReverseIndex];
        this.selectedReverseAnswer = null;
        const container = document.getElementById('reverseQuestion');

        // Generate wrong answers
        const wrongAnswers = this.generateWrongImproperAnswers(challenge);
        const allAnswers = [challenge.answer, ...wrongAnswers].sort(() => Math.random() - 0.5);

        container.innerHTML = `
          <div class="question-text">
            Convert <span style="font-size: 2rem; font-weight: 700; color: var(--field-green);">${challenge.whole} ${challenge.num}/${challenge.den}</span> to an improper fraction:
          </div>
          <div class="answer-options">
            ${allAnswers.map(a => `<button class="answer-btn" onclick="Lesson.selectReverseAnswer('${a}', this)">${a}</button>`).join('')}
          </div>
          <button class="btn btn-primary" id="submitReverse" onclick="Lesson.checkReverse()" style="margin-top: var(--space-lg);">Submit Answer</button>
        `;
      },

      generateWrongImproperAnswers(challenge) {
        const correctNum = challenge.whole * challenge.den + challenge.num;
        const wrong = [];

        wrong.push(`${correctNum + 1}/${challenge.den}`);
        wrong.push(`${correctNum - 1}/${challenge.den}`);
        wrong.push(`${challenge.whole + challenge.num}/${challenge.den}`);

        return wrong.filter(w => w !== challenge.answer).slice(0, 3);
      },

      selectReverseAnswer(answer, btn) {
        this.selectedReverseAnswer = answer;
        document.querySelectorAll('#reverseQuestion .answer-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        document.getElementById('feedback3').className = 'feedback';
      },

      checkReverse() {
        if (!this.selectedReverseAnswer) {
          const feedback = document.getElementById('feedback3');
          feedback.textContent = 'Please select an answer first!';
          feedback.className = 'feedback info';
          return;
        }
        const challenge = this.reverseChallenges[this.currentReverseIndex];
        const buttons = document.querySelectorAll('#reverseQuestion .answer-btn');
        const feedback = document.getElementById('feedback3');
        const answer = this.selectedReverseAnswer;

        buttons.forEach(btn => {
          btn.disabled = true;
          if (btn.textContent === challenge.answer) {
            btn.classList.add('correct');
          } else if (btn.textContent === answer && answer !== challenge.answer) {
            btn.classList.add('incorrect');
          }
        });
        document.getElementById('submitReverse').disabled = true;

        if (answer === challenge.answer) {
          feedback.textContent = `Correct! ${challenge.whole} x ${challenge.den} + ${challenge.num} = ${challenge.whole * challenge.den + challenge.num}`;
          feedback.className = 'feedback correct';
          this.score += 5;
          this.updateScore();

          setTimeout(() => {
            this.currentReverseIndex++;
            if (this.currentReverseIndex < this.reverseChallenges.length) {
              feedback.className = 'feedback';
              this.renderReverseActivity();
            } else {
              document.getElementById('complete3').classList.add('show');
            }
          }, 1500);
        } else {
          feedback.textContent = `Remember: multiply whole by denominator, then add numerator!`;
          feedback.className = 'feedback incorrect';

          setTimeout(() => {
            this.currentReverseIndex++;
            if (this.currentReverseIndex < this.reverseChallenges.length) {
              feedback.className = 'feedback';
              this.renderReverseActivity();
            } else {
              document.getElementById('complete3').classList.add('show');
            }
          }, 2000);
        }
      },

      showActivity(num) {
        for (let i = 1; i <= this.totalActivities; i++) {
          document.getElementById(`activity${i}`).style.display = 'none';
        }
        document.getElementById(`activity${num}`).style.display = 'block';
        this.currentActivity = num;
        document.getElementById('activityNum').textContent = num;
        this.updateProgress();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      },

      updateScore() { document.getElementById('scoreValue').textContent = this.score; },

      updateProgress() {
        const progressPercent = (this.currentActivity - 1) / this.totalActivities;
        const fieldPosition = 10 + (progressPercent * 80);
        const yards = Math.round(progressPercent * 100);
        document.getElementById('footballPosition').style.left = `${fieldPosition}%`;
        document.getElementById('yardsDisplay').innerHTML = `<strong>${yards}</strong> yards gained ‚Ä¢ <strong>${100 - yards}</strong> yards to TD`;
      },

      completeLesson() {
        Storage.completeLesson(2);
        document.getElementById('footballPosition').style.left = '90%';
        document.getElementById('yardsDisplay').innerHTML = '<strong>TOUCHDOWN!</strong>';
        setTimeout(() => { App.celebrateVictory('Chiefs', 2, '../../images/nfl-logos/chiefs.png'); }, 500);
      }
    };

    document.addEventListener('DOMContentLoaded', () => {
      Lesson.init();
      CoachesCorner.init(2);
    });
  </script>
</body>
</html>
